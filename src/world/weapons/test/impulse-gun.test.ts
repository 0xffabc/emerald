import { expect, test } from "@rstest/core";
import { to32xConvertedByte } from "../../../packet/core/utils";
import { ImpulseGun } from "../impulse-gun";

const GLOBAL_PID = 45;

test("Impulse-gun toBytes should return proper packet", () => {
  const gun = new ImpulseGun();

  const packet = gun.toServerUseBytes(GLOBAL_PID);

  expect(packet).toStrictEqual(
    new Uint8Array([
      243,
      4,
      29,
      0,
      3,
      22,
      105,
      ...to32xConvertedByte(GLOBAL_PID),
      70,
      68,
      0,
      0,
      0,
      2,
      115,
      0,
      11,
      99,
      117,
      114,
      114,
      101,
      110,
      116,
      73,
      116,
      101,
      109,
      68,
      0,
      0,
      0,
      3,
      115,
      0,
      4,
      116,
      121,
      112,
      101,
      105,
      0,
      0,
      0,
      2,
      115,
      0,
      9,
      118,
      97,
      114,
      105,
      97,
      110,
      116,
      73,
      100,
      105,
      0,
      0,
      0,
      0,
      115,
      0,
      15,
      117,
      112,
      100,
      97,
      116,
      101,
      73,
      116,
      101,
      109,
      83,
      116,
      97,
      116,
      101,
      105,
      0,
      0,
      0,
      4,
      115,
      0,
      9,
      97,
      110,
      105,
      109,
      97,
      116,
      105,
      111,
      110,
      68,
      0,
      0,
      0,
      2,
      115,
      0,
      5,
      115,
      116,
      97,
      116,
      101,
      115,
      0,
      4,
      73,
      100,
      108,
      101,
      115,
      0,
      9,
      116,
      105,
      109,
      101,
      83,
      116,
      97,
      109,
      112,
      105,
      70,
      131,
      252,
      232,
      254,
      105,
      0,
      0,
      0,
      0,
    ]),
  );
});
